# 4장. 역할, 책임, 협력

인간 본연의 특성이라는 관점에서 인간은 이기적이고 합리적인 존재이다. 그러나 타인과 관계를 맺는 과정 속에서 인간은 본연의 특성을 배제하고 자신의 이익을 최소화하는 불합리한 선택을 한다.

어떤 상황에 처해 있느냐에 따라 인간의 행동을 결정하게 되는 것이다.

여기서의 인간의 행동을 결정하는 상황 즉, 문맥은 타인과의 협력이다. 협력이라는 문맥을 무시한 채 개인의 반응을 독립적으로 예상하고 관찰하는 것은 무의마하다!

**객체의 세계에서도 협력이라는 문맥이 객체의 행동 방식을 결정한다.** 개별 객체가 아닌 객체 사이에 이뤄지는 협력임을 이해하자.

## 협력

협력의 본질은 요청과 응답으로 연결되는 네트워크다. 혼자의 힘으로 해결하기 어렵기 때문에 여러 사람이 참여하게 되며, 이 과정에서 연쇄적인 요청/응답 흐름이 발생한다.

이러한 협력은 한 사람이 다른 사람에게 도움을 **요청** 할 때 시작된다.

### 재판 속의 협력

객체지향 관점에서 재판 장면에 등장하는 모든 인물들은 하트 잭의 재판이라는 동일한 목적을 달성하기 위해 협력하고 있다.

- 누군가가 왕에게 재판을 **요청** 함으로써 재판이 시작된다.
- 왕이 하얀 토끼에게 증인을 부를 것을 **요청** 한다.
- 왕의 요청을 받은 토끼는 모자 장수에게 증인석으로 입장할 것을 **요청** 한다.
- 모자 장수는 증인석에 입장합으로써 토끼의 요청에 **응답** 한다.
- 왕이 토끼에게 요청했던 증인 호출에 대한 **응답** 이기도 하다.
- 왕은 모자 장수에게 증언할 것을 **요청** 한다.
- 모자 장수는 자신이 알고 있는 내용을 증언함으로써 왕의 요청에 **응답** 한다.

이렇게 요청을 받은 객체들은 각각의 의무가 있고, 요청과 응답을 통해 협력에 참여하는 객체가 수행할 책임을 정의한다.

## 책임

객체지향의 세계에서 어떤 객체가 요청에 대해 적절히 응답할 의무가 있는 경우 해당 객체가 **책임** 을 가진다고 한다.

위 예시에서 왕은 '재판을 수행할 책임'이 있고, 토끼는 '증인을 소환할 책임'이 있는 것이다.

책임은 객체지향 설계의 가장 중요한 재료다. **"객체지향 개발에서 가장 중요한 능력은 책임을 능숙하게 소프트웨어 객체에 할당하는 것"** 이라는 말이 있다.

### 책임의 분류

협럭에 참여하는 객체들은 목표를 달성하기 위해 필요한 책임을 수행한다.

객체의 책임은 '객체가 무엇을 알고 있는가(knowing)', '무엇을 할 수 있는가(doing)'로 분류할 수 있다.

**하는 것(doing)**

- 객체를 생성하거나 계산을 하는 등의 '스스로' 하는 것
- 다른 객체의 행동을 시키는 것
- 다른 객체의 활동을 제어하고 조절하는 것

**아는 것(knowing)**

- 개인적인 정보에 관해 아는 것
- 관련된 객체에 관해 아는 것
- 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

_위의 예시로 살펴본다면,_

- 왕의 경우, 다른 객체들의 활동을 제어하고 조율하는 것으로 보아 '하는 것'에 해당된다.
- 하얀 토끼는 목격자가 모자 장수라는 사실을 알고 있으며(아는 것), 모자 장수가 증인석에 입장하도록 요청(하는 것)에 해당되어 두 가지를 가진다.
- 모자 장수는 증인석에 입장해야 하는 책임(하는 것)과 사실을 증언해야 할 책임(아는 것) 두 가지를 가진다.

책임이 불분명한 객체들은 애플리케잉션의 미래 역시 불분명하게 만든다! 명확한 책임이 애플리케이션의 미래를 결정하는 것을 명심하라.

책임은 객체의 **공용 인터페이스(public interface)** 를 구성하여 외부에 제공해 줄 수 있는 서비스를 정의한다.

### 책임과 메시지 

협력 안에서 객체는 다른 객체로부터 요청이 전송됐을 경우에만 자신에게 주어진 책임을 수행한다. 이처럼 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 
**메시지 전송(message-send)** 이라고 한다. 

- 송신자: 협력을 요청하는 객체
- 수신자: 메시지를 받아 요청을 처리하는 객체

이러한 메시지는 협력을 위해 한 객체가 다른 객체로 접근할 수 있는 유일한 방법!

설계를 시작하는 초반에는 어떤 객체가 어떤 책임을 가지고 어떤 방식으로 서로 협력해야 하는지에 대한 개요를 아는 것만으로도 충분하다.

> 객체 지향의 설계는 협력에 참여하기 위해 어떤 객체가 어떤 책임을 수행해야 하고 어떤 객체로부터 메시지를 수신할 것인지를 결정하는 것으로부터 시작된다!

## 역할

협력의 관점에서 `어떤 객체가 어떤 책임의 집합을 수행한다는 것` 이 무슨 의미일까? 

어떤 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 역할을 암시한다. 재판이 이루어지는 과정에서 증인이 요리사, 앨리스로 변경이 되더라도 완벽하게 동일한 과정이 진행된다.

즉, 역할(role) 을 사용하면 협력을 추상화할 수 있다는 것이다.

이러한 역할은 협력 내에서 다른 객체로 대체할 수 있음을 나타내는 일종의 표식이 된다. 물론, 역할을 대체하기 위해서는 각 역할이 수신할 수 있는 메시지를 동일한 방식으로 이해해야 한다.

역할의 개념을 사용하면 다음과 같은 이점이 있다:

- 유사한 협력을 추상화해서 인지 과부하를 줄일 수 있다.
- 다양한 객체들이 협력에 참여할 수 있어 좀 더 유연해지며 재사용성이 높아진다.
- 객체지향 설계의 단순성, 유연성, 재사용성을 뒷받침하는 핵심 개념이다.

